---
title: "Task 1"
author: "Gleb V"
date: "20/07/2020"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE,}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, message = FALSE)
library(tidyverse)
library(here)
```


# Task 1.

#### Overview:

This dataset is a collection of data from a Decathlon competition. 

The original file is in `.rds` format. 
This dataset was relatively tidy to start with. It did not contain any missing data, therefore I did not have to make any assumptions or impute any data manually. 

I performed following operations to clean up this dataset: 

* Changed row names to variable and named it `athlete_name`. 

* Changed all variable names to lowercase and changed all `.`charachters to `_`. 

* Originally data was recorded in wide format, I have pivoted it to long format to make it easier to perform analysis.

* I also changed all of the first column data to UPPERCASE. 

## Answer 1.

```{r}
long_jump <- read_csv(here::here("clean_data/clean_decathlon_data.csv")) %>%
 filter(sport == "long_jump") %>%
 arrange(desc(result)) %>%
 select(athlete_name, result) %>%
 head(1)
long_jump
```
The longest long jump was performed by: `r long_jump` meters.

## Answer 2.

```{r}
avg_100m_both <- read_csv(here::here("clean_data/clean_decathlon_data.csv")) %>%
  filter(sport == "100m") %>%
  group_by(competition) %>%
  summarise(cometition = unique(competition), 
            average_result = round(mean(result),2)) %>%
  select(competition, average_result)
avg_100m_both
```
Average times for 100m sprint across Decastar and OlympicG competitions displayed above

## Answer 3. 

```{r}
#find the Athlete with highest total points across Decastar and OlympicG competitions. 

highest_total_points <- read_csv(here::here("clean_data/clean_decathlon_data.csv")) %>%
  group_by(athlete_name, competition) %>%
  summarise(unique(competition), points = sum(points)/10) %>%
  mutate(athlete_name, 
         competition = unique(competition), 
         total_competition_points = sum(points))%>%
  select(athlete_name, 
         competition,
         points,
         total_competition_points) %>%
  arrange(desc(total_competition_points)) %>%
  head(2)
highest_total_points
  
```
SEBRLE had the highest points total across both competitions. Comined total was 17110 points. 

## Answer 4. 

```{r}
#find top three shot put competitors in each competition
decastar_shot_put <- read_csv(here::here("clean_data/clean_decathlon_data.csv")) %>%
  filter(sport == "shot_put", competition == "Decastar") %>% 
  select(athlete_name, competition, sport, result) %>%
  group_by(athlete_name) %>%
  summarize(athlete_name, competition, sport, result) %>%
  arrange(desc(result)) %>%
  head(3)

olyg_shot_put <- read_csv(here::here("clean_data/clean_decathlon_data.csv")) %>%
  filter(sport == "shot_put", competition == "OlympicG") %>% 
  select(athlete_name, competition, sport, result) %>%
  group_by(athlete_name) %>%
  summarize(athlete_name, competition, sport, result) %>%
  arrange(desc(result)) %>%
  head(3)

bind_rows(decastar_shot_put, olyg_shot_put)
```
Above table shows top three shot put competitors in both competitions.

## Answer 5.

```{r}
#compare average points for competitors who ran 400m in less than 50 sec against those who ran in in more than 50 sec

avg_points_under_50sec_run <- read_csv(here::here("clean_data/clean_decathlon_data.csv")) %>%
  filter(sport == "400m") %>%
  mutate(under_50_sec_run = result < 50) %>%
  group_by(under_50_sec_run) %>%
  summarise(mean_points = round(mean(points), 0)) %>%
  arrange(desc(mean_points))

avg_points_under_50sec_run
```
As it is shown in the above table, those athletes that ran 400m distance in under 50 seconds, accumulated more total points on average than those athletes that completed the same distance in over 50 seconds. 





